### 파이썬 설치

#### 파이썬 설치, 다양한 파이썬 배포판

공식 배포판도 있지만, 개발용 머신에서는 Anaconda Python 추천

* PyPi보다 다양한 C/C++ 라이브러리 바이너리를 Anaconda 측에서 배포
* 일반적인 파이썬 가상환경보다 강력한 Conda Environment
* 설치 주의사항) 환경변수 PATH에 추가 옵션을 필히 체크
* 공식 배포판을 써도 됨

파이썬은 1개만 설치되어있으면 충분

실제 웹서비스에서는 대개 리눅스 운영체제를 사용하며, 이때에는 대개 운영체제 배포판에서 제공해주는 파이썬을 사용하게 됨

https://www.anaconda.com/distribution/

cmd창

```
python --version
conda --version

conda create --name seolyulab python=3.7
conda activate seolyulab

where python
where pip

python

exit()
```



### 파이썬 실행 확인

터미널 띄우기

* 윈도우 : 명령프롬프트 혹은 PowerShell
* 맥 : 터미널 혹은 iTerm2
* 리눅스 : 터미널



### 주의할 것

실행환경(OS)별로 수행하는 파이썬 명령어 다를 수 있음

- 맥에서는 python 명령으로 파이썬 버전2이 실행될 수 있는데 그럴 땐 python3 명령을 입력

  파이썬 인터프리터가 다수 설치되어있을 수 있기 때문

- 사용하는 python/pip 명령이 어떤 버전의 파이썬을 실행하는 지, 명확한 인지가 필요

  윈: where python 명령, 맥/리눅스: which python 명령

- 환경변수 PATH에 대한 명확한 이해가 필요

파이썬 하나만 설치

* 맥/리눅스에 기본 설치된 파이썬은 절대 삭제하지말고, 무시하고 추가로 하나만 설치

  환경변수 PATH 제대로 확인

* 윈도우에서는 Anaconda Python 하나만 설치

```
python --version
pip --version

where python
where pip
```





## 장고 설치

Django 공식 소스 저장소

https://github.com/django/django

Django Versions

* LTS (Long Term Support) 버전: 대개 3년동안 업데이트를 지원
* 비동기를 공식 지원하는 3.0 버전은 2019년 12월에 정식 릴리즈 (완전한 비동기 지원은 4.0에서)

설치 : 파이썬 팩키지 매니저인 pip를 이용

* 명령) pip install "django~=3.0.0" => 3.0.* 버전 중에 최신 버전 설치를 시도

```
가상환경 상태에서
pip install "django~=3.0.0"
```

pypi.org

`django-admin --version`  //  `python -m django --version`



### Visual Studio Code 설치

'code(으)로 열기' 작업을 windows 탐색기 디렉터리의 상황에 맞는 메뉴에 추가 체크

Python 익스텐션 설치

view-Command Palette(Ctrl+Shift+P) 에서 

Python:Select Interpreter 선택 -> 콘다 선택 -> seolyulab

![seolyulab](./imgs/seolyulab.png)



cmd 에 python manage.py runserver

VSCode 에 Terminal - new Terminal 하면 `conda activate ...` 알아서 됨



Ctrl+Shift+P

Terminal: Select Default Shell - 명령프롬프트 선택





## 장고 프로젝트 생성

django-admin startproject 프로젝트명

python -m django startproject 프로젝트명

cmd 창에서

`conda env list`  // 설치된 가상환경 확인

`conda activate 가상환경명`

프로젝트 만들 곳 가서

`django-admin startproject 프로젝트명`

`dir`

`cd 프로젝트명`

참고) `cd \` 최상위(홈)로 이동. 맥에서는 `cd ~`

`start .`  // 현재 디렉터리 탐색기 띄우기. 맥에서는 `open .`



기본 생성된 파일/디렉토리 목록

기본 템플릿 : django/conf/project_template

seolyupjt : 프로젝트명으로 생성된 디렉토리. 다른 이름으로 변경해도 Don't care.

* manage.py : 명령행을 통해 각종 장고 명령을 수행

* seolyupjt : 프로젝트명으로 생성된 디렉토리. 이 이름을 참조하고 있는 코드가 몇 개 있기에(manage.py랑 settings.py, wsgi.py에서) 함부로 수정 X

  ```
  __init__.py : 모든 파이썬 팩키지에는 __init__.py을 둔다. 팩키지를 임포트할 때의 임포트 대상
  settings.py : 현재 프로젝트에서 장고 기본설정 (django/conf/global_settings.py) 을 덮어쓰고, 새롭게 지정할 설정들
  urls.py : 최상위 URL 설정
  wsgi.py : 실서비스에서의 웹서비스 진입점
  asgi.py <- 비동기쪽 지원 추가된 프로토콜. 실서비스에서의 웹서비스 진입점
  ```



### 프로젝트 초기화 작업 및 개발서버 구동

파이썬 명령은 각 머신의 파이썬3 세팅에 따라, python, python3 혹은 python3.7 등이 될 수 있다

`django-admin startproject 프로젝트명`

`cd 프로젝트명`

`python manage.py migrate`

`python manage.py createsuperuser`

`python manage.py runserver`

웹브라우저를 띄워, http://localhost:8000/admin/ 으로 접속하고 로그인(윈도우의 컴퓨터 이름이나 계정명이 한글일 경우 서버 구동에 실패할 수도 있어서 이름을 영어로 변경 후 다시 시도)

생성한 superuser로 로그인



웹서비스 개발 시의 웹브라우저는 가급적 Google Chrome이나 Mozilla Firefox를 사용

최신 웹기술을 지원하고 있고, 웹브라우저 개발자 도구 지원이 좋으며, 다양한 개발용 확장들이 있어서

가급적 운영체제의 기본 브라우저 설정을 Chrome으로 변경





## 장고 주요 구성요소

### 장고 주요 기능들(1)

1. Function Based Views : 함수로 HTTP 요청 처리
2. Models : 데이터베이스와의 인터페이스
3. Templates : 복잡한 문자열 조합을 보다 용이하게. 주로 HTML 문자열 조합 목적으로 사용하지만, 푸쉬 메세지나 이메일 내용을 만들 때에도 쓰면 편리.
4. Admin 기초 : 심플한 데이터베이스 레코드 관리 UI
5. Logging : 다양한 경로로 메세지 로깅
6. Static files : 개발 목적으로의 정적인 파일 관리
7. Messages framework : 유저에게 1회성 메세지 노출 목적

### 장고 주요 기능들(2)

1. Class Based Views : 클래스로 함수 기반 뷰 만들기

2. Forms : 입력폼 생성, 입력값 유효성 검사 및 DB로의 저장

   Validators & Fields & Widgets

3. 테스팅

4. 국제화 & 지역화

5. 캐싱

6. Geographic : DB의 Geo 기능 활용 (PostgreSQL 중심)

7. Sending Emails

8. Syndication Feeds (RSS/Atom)

9. Sitemaps



장고 기본 앱 https://github.com/django/django/tree/master/django/contrib

admin, admindocs, auth, contenttypes, flatpages, gis, humanize, messages, postgres, redirects, sessions, sitemaps, sites, staticfiles, sydication



웹 애플리케이션 기본 구조

```
웹브라우저 <=> 다양한 언어/프레임워크로 만드는 웹 서버(Django)
<=> 데이터베이스 서버(SQLite, MySQL, PostgreSQL 등) / 캐시 서버(Memcached, Redis)
```



장고 기본 구조

```
URLConf(미리 URL별로 호출할 함수를 리스트에 등록)
뷰(View)(URL에 맞춰 호출된 함수)
모델(파이썬 코드로 데이터베이스와 통신)
템플릿 엔진(복잡한 문자열을 손쉽게 조합하기 위한 문자열 렌더링 엔진)
```





## 장고 앱

장고 앱의 필요성

현재 프로젝트의 블로그 기능을 다른 프로젝트에서도 사용하려한다면?

블로그를 장고앱 형태로 격리해서 만들어둔다면, 다른 프로젝트에도 적용하기 편리.

아래 명령으로 기본 앱템플릿으로부터 생성

`python manage.py startapp <앱이름>`

```
python manage.py startapp blog1

blog1 폴더에 urls.py 추가
```

urls.py

```python
urlpatterns = [
]
```



### 장고 앱

#### 재사용성을 목적으로한 파이썬 팩키지

재사용성을 목적으로 둔 것이 아니라면, 하나의 장고 앱에서 현재 프로젝트의 거의 모든 기능을 구현해도 무방

앱을 하나의 작은 서비스로 봐도 무방

#### 하나의 앱이름은 현재 프로젝트 상에서 유일해야함

#### 새롭게 생성한 장고앱이나 외부 라이브러리 형태의 장고앱은 필히 settings.INSTALLED_APPS 에 등록을 시켜줘야만 장고앱으로서 대접을 받음

seolyupjt > settings.py

```python
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'blog1',
]
```

앱의 URLConf 를 제외한 많은 부분(모델, 템플릿, static 등)들이 자동으로 등록



blog1 > models.py

```python
from django.db import models

class Post(models.Model):
    title = models.CharField(max_length=100)
    content = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
```

`python manage.py makemigrations blog1`

`python manage.py migrate blog1`

+ `python manage.py runserver`

blog1 > admin.py

```python
from django.contrib import admin
from .models import Post

admin.site.register(Post)
```

http://127.0.0.1:8000/admin/ 새로고침

seolyupjt > urls.py

```python
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('blog1/', include('blog1.urls')),
]
```

blog1 > views.py

```python
from django.shortcuts import render
from .models import Post

def post_list(request):
    qs = Post.objects.all()  # QuerySet
    return render(request, 'blog1/post_list.html', {
        'post_list': qs,
    })
```

templates/blog1/post_list.html 새파일 만들기

```html
<h1>Post List</h1>

{% for post in post_list %}
    <h2>{{ post.title }}</h2>
    {{ post.content }}
{% endfor %}
```

blog1 > urls.py

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.post_list, name='post_list'),
]
```

http://127.0.0.1:8000/ 

404 에러

http://127.0.0.1:8000/blog1/